<!DOCTYPE html>
<html lang="de">
<meta charset="UTF-8" />

<script src="../../../../node_modules/@smartdesign/header-layout/dist/header-layout-with-externals.js"></script>
<script src="../../../../node_modules/@smartdesign/button/dist/button-with-externals.js"></script>
<script src="../../../../node_modules/@smartdesign/lit-input/dist/input-with-externals.js"></script>


<link rel="stylesheet" href="../../../style/style.css">

<head>

  <title></title>
  <div id="declarative-example-root">
    <base href="../../../../node_modules/@smartdesign/icons/toolbar/">
    <sd-toolbar>
      <sd-button icon="refresh.svg" slot="left" onclick="reloadPage()"></sd-button>
      <h2 slot="middle">Allgemein</h2>
      <sd-button icon="cancel.svg" slot="right" onclick="redirectToHomePage()"></sd-button>
    </sd-toolbar>
  </div>

</head>

<div class="examples">

  <div class="example-container">
    <span>Turniername</span>
    <sd-lit-input id="turnierName" type="text" name="turnierName" required  class="smartdesign-global-smartsearch" placeholder="Fußballturnier Controlling"></sd-lit-input>
  </div>

    <div class="example-container">
      <span>Startdatum</span>
      <sd-lit-input type="date" id="startDatum" name="startDatum" required class="smartdesign-global-smartsearch"></sd-lit-input>
    </div>

    <div class="example-container">
      <span>Anmeldeschluss</span>
      <sd-lit-input type="date" id="endDatum" name="endDatum" required class="smartdesign-global-smartsearch"></sd-lit-input>
    </div>

    <div class="example-container">
      <span>Veranstaltungsort</span>
      <sd-lit-input id="veranstaltungsort" type="text" name="veranstaltungsort" required  class="smartdesign-global-smartsearch" placeholder="Karlsruhe"></sd-lit-input>
    </div>

    <div class="example-container">
      <span>Startzeit</span>
      <sd-lit-input id="startZeit" type="time" name="startZeit" required  class="smartdesign-global-smartsearch"></sd-lit-input>
    </div>

    <div class="example-container">
      <span>Kosten</span>
      <sd-lit-input type="text" id="kosten" name="kosten" required placeholder="€" oninput="formatCurrency(this)" class="smartdesign-global-smartsearch"></sd-lit-input>
    </div>

    <!--Darstellung als Dezimalzahl-->

    <script>
      function formatCurrency(input) {
        // Beispiel: Formatierung auf zwei Dezimalstellen
        input.value = parseFloat(input.value).toFixed(2);
      }
      function redirectToHomePage() {
        // Hier die Basis-URL der aktuellen Seite abrufen und auf die Hauptseite weiterleiten
        window.location.href = window.location.origin;
      }

      function reloadPage() {
        // Seite neu laden
        window.location.reload();
      }
    </script>



</div>

<form id="tournamentForm">
<div class="parent-container">
  <sd-button type="submit" primary onclick="submitForm()" > Turnier erstellen </sd-button>
</div>
</form>
<script>
  function validateForm() {
    const inputs = document.querySelectorAll('.example-container sd-lit-input');

    for (const input of inputs) {
      if (!input.value) {
        alert('Bitte füllen Sie alle Felder aus.');
        return false;
      }
    }

    return true;
  }
</script>

<script>
  async function createTurnier() {
    const tournamentData = {
      turnierName: document.getElementById("turnierName").value,
      startDatum: document.getElementById("startDatum").value,
      endDatum: document.getElementById("endDatum").value,
      veranstaltungsort: document.getElementById("veranstaltungsort").value,
      startZeit: document.getElementById("startZeit").value,
      kosten: document.getElementById("kosten").value
    };

    try {
      const response = await fetch("https://turniersystem.onrender.com/create-turnier", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(tournamentData),
      });

      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }

      const data = await response.json();
      console.log("Turnier erstellt:", data);
      alert("Turnier erfolgreich erstellt!");
    } catch (error) {
      console.error("Fehler beim Senden der Daten:", error);
      alert("Fehler beim Erstellen des Turniers. Bitte versuche es erneut.");
    }
  }

  // Manuell das Submit-Ereignis auslösen, wenn die Validierung erfolgreich ist
  function submitForm() {
    if (validateForm()) {
      createTurnier();
    }
  }
</script>

</script>
  </body>
  </sd-header-layout>
</html>
